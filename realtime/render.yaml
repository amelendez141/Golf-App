# ===========================================
# LinkUp Golf Realtime Server - Render.com Configuration
# ===========================================
# Deploy to Render: https://render.com
# Note: WebSocket support requires paid plan on Render

services:
  - type: web
    name: linkup-golf-realtime
    runtime: node
    region: ohio  # US East, close to Neon DB
    plan: starter  # $7/mo - Required for WebSocket support

    # Build configuration
    buildCommand: npm ci && npx prisma generate && npm run build
    startCommand: npm start

    # Health check
    healthCheckPath: /health

    # Environment
    envVars:
      - key: NODE_ENV
        value: production
      - key: WS_PORT
        value: "3002"
      - key: DATABASE_URL
        sync: false  # Set manually in Render dashboard
      - key: REDIS_URL
        sync: false  # Required for BullMQ jobs
      - key: JWT_SECRET
        sync: false
      - key: LOG_LEVEL
        value: info
      - key: VAPID_PUBLIC_KEY
        sync: false  # Optional: Push notifications
      - key: VAPID_PRIVATE_KEY
        sync: false
      - key: VAPID_SUBJECT
        value: mailto:notifications@linkupgolf.com
      - key: SMTP_HOST
        sync: false  # Optional: Email notifications
      - key: SMTP_PORT
        value: "587"
      - key: SMTP_USER
        sync: false
      - key: SMTP_PASS
        sync: false
      - key: SMTP_FROM
        value: "LinkUp Golf <notifications@linkupgolf.com>"

    # Auto-deploy on push to main
    autoDeploy: true

    # Node version
    nodeVersion: "20"
